<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sigmatic - Natural Language Data Chatbox</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <link href="{{ url_for('static', filename='css/style.css') }}" rel="stylesheet">
</head>
<body>
    <div class="container-fluid">
        <div class="row">
            <!-- Header -->
            <div class="col-12">
                <nav class="navbar navbar-expand-lg navbar-dark bg-primary">
                    <div class="container-fluid">
                        <a class="navbar-brand" href="#">
                            <i class="fas fa-chart-line me-2"></i>
                            Sigmatic
                        </a>
                        <span class="navbar-text">
                            Natural Language Data Chatbox
                        </span>
                    </div>
                </nav>
            </div>
        </div>

        <div class="row mt-4">
            <!-- File Upload Section -->
            <div class="col-md-4">
                <div class="card">
                    <div class="card-header">
                        <h5><i class="fas fa-upload me-2"></i>Data Upload</h5>
                    </div>
                    <div class="card-body">
                        <form id="uploadForm" enctype="multipart/form-data">
                            <div class="mb-3">
                                <label for="fileInput" class="form-label">Select CSV File</label>
                                <input type="file" class="form-control" id="fileInput" name="file" accept=".csv" required>
                                <div class="form-text">Maximum 2 files allowed. Files are session-based and will be cleared when you close the browser.</div>
                            </div>
                            <button type="submit" class="btn btn-primary">
                                <i class="fas fa-upload me-2"></i>Upload File
                            </button>
                        </form>
                        
                        <hr>
                        
                        <div id="uploadedFiles">
                            <h6>Uploaded Files</h6>
                            <div id="filesList"></div>
                        </div>
                        
                        <div class="mt-3">
                            <button id="clearSession" class="btn btn-outline-danger btn-sm">
                                <i class="fas fa-trash me-2"></i>Clear All Files
                            </button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Data Preview Section -->
            <div class="col-md-8">
                <div class="card">
                    <div class="card-header">
                        <h5><i class="fas fa-table me-2"></i>Data Preview</h5>
                    </div>
                    <div class="card-body">
                        <div id="dataPreview">
                            <div class="text-center text-muted">
                                <i class="fas fa-upload fa-3x mb-3"></i>
                                <p>Upload a CSV file to preview your data</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Chat Section -->
        <div class="row mt-4">
            <div class="col-12">
                <div class="card">
                    <div class="card-header">
                        <h5><i class="fas fa-comments me-2"></i>Natural Language Query</h5>
                    </div>
                    <div class="card-body">
                        <div id="chatContainer">
                            <div id="chatMessages" class="chat-messages">
                                <div class="chat-message system">
                                    <div class="message-content">
                                        <i class="fas fa-robot me-2"></i>
                                        Hello! I'm your AI data analyst. Ask me questions about your data in natural language. 
                                        Try queries like "Show me patients over 70 years old" or "How many patients died during the study?"
                                    </div>
                                </div>
                            </div>
                            
                            <div class="chat-input-container">
                                <form id="queryForm" class="d-flex">
                                    <input type="text" id="queryInput" class="form-control me-2" 
                                           placeholder="Ask a question about your data..." required>
                                    <button type="submit" class="btn btn-primary">
                                        <i class="fas fa-paper-plane"></i>
                                    </button>
                                </form>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Loading Modal -->
    <div class="modal fade" id="loadingModal" tabindex="-1">
        <div class="modal-dialog modal-sm">
            <div class="modal-content">
                <div class="modal-body text-center">
                    <div class="spinner-border text-primary" role="status">
                        <span class="visually-hidden">Loading...</span>
                    </div>
                    <p class="mt-2">Processing...</p>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="{{ url_for('static', filename='js/app.js') }}"></script>
</body>
</html> 